# 原型

#### 原型对象

在JavaScript中所有的函数有一个prototype属性，这个属性指向一个对象，这个对象的用途是：*包含所有可以被实例共享的属性和方法*。

这也是原型被创建的**原因**，用于实例的共享属性，用于解决构造函数无法共享属性和方法的问题。

```javascript
function obj(){
};
obj.prototype.name = 'lili';
obj.prototype.age = 14;
let lili = new obj();
let xiaoming = new obj();
console.log(lili.name); //lili
console.log(xiaoming.name); //xiaoming
```

上面obj构造函数生成的实例，共享obj.prototype对象上的属性。

#### 委托

如果一个对象中不存在我们访问的属性，则JavaScript会在对象的原型上检查属性。这也就称之为**委托**。当代码读取一个对象的属性时，都会优先在对象实例本身开始查找，如果没有找到则会在对象原型对象中查找。

如果对象本身和原型对象上有相同名字的属性或方法，本身的属性只会屏蔽原型对象上的那个属性。

```JavaScript
const lili = {
  name:`lili`
},
huahua = {
  name:`huahua`
}
//检测对象中是否有toString方法
Object.hasOwnProperty(lili,toString); //false
Object.hasOwnProperty(huahua,toString); //false

//调用toString方法
lili.toString();  //'[object Object]'
huahua.toString();  //'[object Object]'
```

没有在自身对象上检测到toString方法时，会在原型上检测是否存在toString方法。从而调用原型上的方法。

我们就可以访问到对象上并不存在的属性，只要其的原型上有这些属性。我们可以利用这一点将属性和方法赋值到对象的原型上，然后我们就可以调用这些属性，好像它们真的存在在那个对象上一样。

原型上的属性是共有的，不是单独的将属性拷贝到每一个对象上。

这也就是大家常说的**原型继承**。如果对象没有，但对象的原型有，那我的对象也能*继承*这个属性。这里的*继承*并没有发生传统面向对象中继承的复制操作，而只是*委托到原型上*。

#### 设置对象的原型

当我们创建一个函数，这个函数就会有一个属性prototype，指向一个叫做prototype的对象。

与之相反prototype对象会有一个contructor的属性，它的引用指回函数。

设置原型对象有三个规则：
1. 默认规则
2. 使用new隐式规则
3. 使用Object.create显式设置原型

###### 默认规则

```javascript
const food = {name:'lili'};
```

当创建一个对象，JavaScript将原型对象指向Object.prototype并设置原型的contructor的属性为Object。

###### new隐式规则

```javascript
function food (name){
  name:`lili`
}
const food = new food(`lili`);
```

当我们使用new关键字创建一个对象，原型指向new关键字调用函数的prototype属性。这个对象的contructor属性指向我们使用new调用的构造函数。

###### 使用Object.create显式设置原型

最后我们使用Object.create方法手动设置对象的原型引用。

```javascript
const foo = {
    speak () {
        console.log('Foo!');
    }
};
const bar = Object.create(foo);
bar.speak(); // 'Foo!'
Object.getPrototypeOf(bar) === foo; // true
```

Object.create方法在幕后做了下面的三件事：
1、创建一个新对象；
2、设置它的原型引用；
3、返回这个新对象。

#### 总结

Javascript中原型始终是实现继承等功能的核心所在，即使在ES6中加入class相关的语法糖。它只是提供了一种更加方便的语法来创建通过原型关联的对象，本质上没有什么新东西。

我们应该了解JavaScript的原型机制，可以让我们在class的原理上理解class的由来和作用。

