# 组件注册（模块系统）

### 使用模块系统组册组件

一下依据使用了babel和webpack的模块系统。

我们通常会（也是vue官方推荐）创建一个components目录，将每个组件放置在其各自的文件中。然后在你需要的局部注册之前导入每个你想使用的组件。

如：我们想在head.vue中使用a,b两个组件：

```
// head
import a from './component-a'
import b from './component-b'

export default{
    components:{
        a,
        b    
    }
}

```

现在a和b都可以在head.vue中使用了。

### 基础组件的自动化全局注册

首先我们应该知道基础组件的概念，

基础组件：我们会在各个组件中频繁的用到的元素。如相对通用的输入框或按钮等。

```
import Button from './Button.vue'
import Icon from './Icon.vue'
import Input from './Input.vue'

export default {
  components: {
    Button,
    Icon,
    Input
  }
}

```

在模版中使用这些基础组件：

```
<Input
  v-model="searchText"
  @keydown.enter="search"
/>
<Button @click="search">
  <Icon name="search"/>
</Button>
```

而我们可以使用另一种方式全局组册这些非常通用的基础组件，通过应用入口文件中全局导入基础组件：


```
import Vue from 'vue'
import upperFirst from 'lodash/upperFirst'
import camelCase from 'lodash/camelCase'

const requireComponent = require.context(
  // 其组件目录的相对路径
  './components',
  // 是否查询其子目录
  false,
  // 匹配基础组件文件名的正则表达式
  /Base[A-Z]\w+\.(vue|js)$/
)

requireComponent.keys().forEach(fileName => {
  // 获取组件配置
  const componentConfig = requireComponent(fileName)

  // 获取组件的 PascalCase 命名
  const componentName = upperFirst(
    camelCase(
      // 剥去文件名开头的 `./` 和结尾的扩展名
      fileName.replace(/^\.\/(.*)\.\w+$/, '$1')
    )
  )

  // 全局注册组件
  Vue.component(
    componentName,
    // 如果这个组件选项是通过 `export default` 导出的，
    // 那么就会优先使用 `.default`，
    // 否则回退到使用模块的根。
    componentConfig.default || componentConfig
  )
})
```

切记：全局注册的行为我们必须在根vue实例创建之前发生。


